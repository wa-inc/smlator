#!/bin/bash

# Function to display the menu
display_menu() {
    echo "Welcome to SM Gaming!"
    echo "Please select an option:"
    echo "1. Open the Winlator app"
    echo "2. Uninstall the Winlator app"
    echo "3. Uninstall SM Gaming script"
    echo "4. Exit"
}

# Function to handle the user's choice
handle_choice() {
    read -p "Enter your choice: " choice
    case $choice in
        1)
            open_app
            ;;
        2)
            uninstall_app
            ;;
        3)
            uninstall_script
            ;;
        4)
            echo "Exiting..."
            exit 0
            ;;
        *)
            echo "Invalid choice. Please try again."
            handle_choice
            ;;
    esac
}

# Function to open the Winlator app
open_app() {
    if pkg list-installed com.winlator &> /dev/null; then
        am start -n $(pm list packages -f | grep -i "com.winlator" | awk -F'=' '{print $1}' | xargs)
    else
        echo "The Winlator app is not installed."
    fi
}

# Function to uninstall the Winlator app
uninstall_app() {
    if pkg list-installed com.winlator &> /dev/null; then
        pm uninstall com.winlator
        echo "The Winlator app has been uninstalled."
    else
        echo "The Winlator app is not installed."
    fi
}

# Function to uninstall the SM Gaming script
uninstall_script() {
    echo "Uninstalling SM Gaming script..."
    rm -f "$0"
    echo "SM Gaming script has been uninstalled."
}

# Function to install the Winlator app
install_app() {
    echo "Installing the Winlator app..."
    curl -LO https://github.com/brunodev85/winlator/releases/download/v5.0.0/Winlator_5.0.apk
    pkg install -y ./Winlator_5.0.apk
    echo "Winlator app has been installed."
}

# Main function
main() {
    install_app
    while true; do
        display_menu
        handle_choice
    done
}

main
